<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monitor Counter with BMS ID & Production Days</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f4f6f8;
        display: flex;
        justify-content: center;
        padding: 30px 20px;
    }

    .container {
        background-color: #fff;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        width: 100%;
        max-width: 950px;
    }

    h1 {
        text-align: center;
        margin-bottom: 20px;
        color: #1a73e8;
    }

    .daily-counter {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #e1f0ff;
        padding: 15px 20px;
        border-radius: 8px;
        font-weight: bold;
        margin-bottom: 25px;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    .daily-counter button {
        background-color: #ff4d4f;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 5px 12px;
        cursor: pointer;
        transition: 0.3s;
    }

    .daily-counter button:hover {
        background-color: #d9363e;
    }

    .employee-list {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .employee {
        display: flex;
        flex-direction: column;
        padding: 20px 25px;
        background-color: #f9fbff;
        border-left: 5px solid #1a73e8;
        border-radius: 10px;
        transition: all 0.3s;
    }

    .employee:hover {
        background-color: #eef4ff;
        transform: scale(1.01);
    }

    .employee-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        flex-wrap: wrap;
    }

    .employee-info {
        font-size: 0.95em;
        color: #333;
        margin-bottom: 8px;
    }

    .counter-section {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .counter {
        font-weight: bold;
        font-size: 1.2em;
        width: 35px;
        text-align: center;
    }

    button {
        padding: 6px 14px;
        font-size: 0.95em;
        background-color: #1a73e8;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    button:hover {
        background-color: #1669c1;
    }

    textarea {
        width: 100%;
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #ccc;
        font-family: inherit;
        font-size: 0.95em;
        resize: vertical;
        min-height: 50px;
        margin-bottom: 8px;
    }

    .comments {
        margin-top: 10px;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .comment {
        background-color: #fff;
        padding: 6px 10px;
        border-radius: 5px;
        border-left: 3px solid #1a73e8;
        font-size: 0.95em;
        color: #333;
        position: relative;
    }

    .comment-date {
        font-weight: bold;
        margin-right: 5px;
        color: #555;
        font-size: 0.85em;
    }

    .delete-comment-btn {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        background: red;
        border: none;
        color: white;
        padding: 2px 6px;
        font-size: 0.8em;
        border-radius: 3px;
        cursor: pointer;
    }

    footer {
        margin-top: 40px;
        text-align: center;
        font-size: 0.9em;
        color: #555;
        border-top: 1px solid #ccc;
        padding-top: 15px;
        font-style: italic;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Monitor Assignment Counter For January 2026</h1>
    <div class="daily-counter">
        Total Monitors Today: <span id="dailyCounter">0</span>
        <button onclick="resetDailyCounter()">Reset</button>
    </div>
    <div class="employee-list" id="employeeList"></div>
    <footer>
        Omar Essam Zakaria | Quality Assurance Analyst @ IHG - InterContinental Hotels Group
    </footer>
</div>

<script>
// Employee list with BMS ID, Name, Production Date
const employees = [
    {bms:"6010910", name:"Abdelrahman Diab", prodDate:"23/07/2025"},
    {bms:"6008171", name:"Ahmed Sobeih", prodDate:"14/07/2025"},
    // ... (keep all your employees as before)
];

// Load saved counters and comments from localStorage or initialize
let counters = JSON.parse(localStorage.getItem('monitorCounters')) || {};
let comments = JSON.parse(localStorage.getItem('employeeComments')) || {};
let dailyCounter = JSON.parse(localStorage.getItem('dailyCounter')) || 0;

employees.forEach(emp => {
    if (!(emp.bms in counters)) counters[emp.bms] = 0;
    if (!(emp.bms in comments)) comments[emp.bms] = [];
});

// Function to calculate days from production date to today
function daysFromProduction(prodDateStr){
    const parts = prodDateStr.split('/');
    const prodDate = new Date(`${parts[2]}-${parts[1]}-${parts[0]}`);
    const today = new Date();
    const diffTime = today - prodDate; // in milliseconds
    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
    return diffDays;
}

// Render employees
function renderEmployees(){
    document.getElementById('dailyCounter').innerText = dailyCounter;
    const employeeList = document.getElementById('employeeList');
    const sortedEmployees = [...employees].sort((a,b) => counters[a.bms] - counters[b.bms]);

    employeeList.innerHTML = '';
    sortedEmployees.forEach(emp=>{
        const div = document.createElement('div');
        div.className = 'employee';

        const commentHtml = comments[emp.bms].map((c, idx) => 
            `<div class="comment">
                <span class="comment-date">${c.date}:</span>${c.text}
                <button class="delete-comment-btn" onclick="deleteComment('${emp.bms}', ${idx})">X</button>
            </div>`).join('');

        div.innerHTML = `
            <div class="employee-header">
                <div class="employee-info">
                    <strong>${emp.name}</strong> | BMS: ${emp.bms} | Days since production: ${daysFromProduction(emp.prodDate)}
                </div>
                <div class="counter-section">
                    <button onclick="decrementCounter('${emp.bms}')">-</button>
                    <span class="counter">${counters[emp.bms]}</span>
                    <button onclick="incrementCounter('${emp.bms}')">Monitor Completed</button>
                </div>
            </div>
            <textarea id="comment-${emp.bms}" placeholder="Add a comment..."></textarea>
            <button onclick="submitComment('${emp.bms}')">Submit Comment</button>
            <div class="comments">${commentHtml}</div>
        `;
        employeeList.appendChild(div);
    });
}

// Increment counter
function incrementCounter(bms){
    counters[bms]++;
    dailyCounter++;
    localStorage.setItem('monitorCounters', JSON.stringify(counters));
    localStorage.setItem('dailyCounter', JSON.stringify(dailyCounter));
    renderEmployees();
}

// Decrement counter
function decrementCounter(bms){
    if(counters[bms] > 0){
        counters[bms]--;
        if(dailyCounter > 0) dailyCounter--;
        localStorage.setItem('monitorCounters', JSON.stringify(counters));
        localStorage.setItem('dailyCounter', JSON.stringify(dailyCounter));
        renderEmployees();
    }
}

// Reset daily counter
function resetDailyCounter(){
    if(confirm("Are you sure you want to reset today's counter?")){
        dailyCounter = 0;
        localStorage.setItem('dailyCounter', JSON.stringify(dailyCounter));
        renderEmployees();
    }
}

// Submit comment
function submitComment(bms){
    const text = document.getElementById(`comment-${bms}`).value.trim();
    if(text === "") return alert("Comment cannot be empty.");
    const date = new Date().toLocaleDateString();
    comments[bms].push({date,text});
    localStorage.setItem('employeeComments', JSON.stringify(comments));
    document.getElementById(`comment-${bms}`).value = "";
    renderEmployees();
}

// Delete comment
function deleteComment(bms, idx){
    if(confirm("Are you sure you want to delete this comment?")){
        comments[bms].splice(idx, 1);
        localStorage.setItem('employeeComments', JSON.stringify(comments));
        renderEmployees();
    }
}

// Initial render
renderEmployees();
</script>
</body>
</html>
